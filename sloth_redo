# Install packages
install.packages("tidyverse")
install.packages("GGally")

# Load packages
library(tidyverse)
library(GGally)

# Create a data directory that can be reproducible
dat <- read_csv("data/sloth_data.csv")

#view the characteristic of the dataset such as variable types
glimpse(dat)

#view the number of columns in the dataset
ncol(dat)

#view the number of rows in the dataset
nrow(dat)

#another way to summarize the dataset
str(dat)

#show the table version of the data set
tibble(dat)

#the index column is not needed. Remove the index column
#and assign a new name to the new data set
dat <- select(data, -X)

#confirm that the Index column has been removed
glimpse(dat)

#rename some of the variables
dat <- rename(sloth_data, "endangered_status" = "endangered",
                     "main_species" = "specie", "sub_species" = "sub_specie")

# Cross-check
glimpse(dat)

# Organize rows by endangerement, from least to most concerning
endangerment_levels <- c("least_concern", "vulnerable", "critically_endangered")
dat<- dat %>%
  mutate(endangerment_status = factor(endangerment_status, levels = endangerment_levels)) %>%
  arrange(endangerment_status)

# Sort columns by qualitative first and then quantitative second
dat <- dat[, c(4, 5, 2, 3, 7, 1, 6)]
glimpse(dat)

# Check for missing values
is.na(dat)

# Double-check
which(is.na(dat))

# Check for duplicates
duplicated(dat)
which(duplicated(dat))

# We want to check the absolute frequency of the observations in the endangered_status column
table(dat$endangered_status)

# Stacked bar chart
graph_1 <- ggplot(dat, aes(fill = sub_species, x = endangered_status)) + 
  geom_bar(sub_species = 'stack') +
  labs(
    title = "Endangered Status of Sloth Sub-Species" ,
    subtitle = "Number of Observations per Conservation Status" , 
    x = "Endangered Status" ,
    y = "Number of Observations",
    fill = "Sub Species") +
  scale_x_discrete(labels = c("Critically Endangered", "Least Concern", "Vulnerable")) +
  scale_fill_discrete(labels = c("Brown-Throated Sloth", "Hoffman's Two-Toed Sloth",
                                 "Linnaeus's Two-Toed Sloth", "Maned Three-Toed Sloth",
                                 "Pale-Throated Sloth", "Pygmy Three-Toed Sloth")) +
                                  scale_fill_manual(values = c("dodgerblue3", "orchid4", "palevioletred",
                                  "lightskyblue1", "royalblue4", "cyan3"))


# Box plot graph
graph_2 <- dat %>% 
  ggplot() +
  geom_boxplot(aes(x = main_species,
                   y = claw_length,
                   fill = main_species)) +
    labs(
    title = "Claw Length Comparison of Main Species" ,
    subtitle = "Two-Toed Sloth vs. Three-Toed Sloth" , 
    x = "Main Species" ,
    y = "Claw Length (cm)",
    fill = "Main Species") +
    scale_x_discrete(labels = c("Three-Toed", "Two-Toed")) +
    scale_fill_manual(labels = c("Three-Toed", "Two-Toed"),
                    values = c("dodgerblue3", "brown2"))
                   
# To filter out the dataset for only two-species
data_2t <- dat %>%
  filter(main_species == "two_toed")

#check the new dataframe to confirm
glimpse(data_2t)

#to filter out the dataset for only three toed-species
data_3t <- dat %>%
  filter(main_species == "three_toed")

#check the new dataframe to confirm
glimpse(data_3t)

# to get a summary of the central tendencies for each main species and their claw lengths
summary(data_2t$claw_length_cm)
summary(data_3t$claw_length_cm)

                  
#add an additional column to the dataset by combining the size and tail length columns
total_length_cm <- dat$size_cm + dat$tail_length_cm

total_length_cm

#add the new column to the dataset
dat <- cbind(dat, total_length_cm)

glimpse(dat)

#make scatter plot for two-toed species length and weight
graph_3a <- data_2t %>% 
  ggplot(aes(x = total_length_cm,
             y = weight_kg,
             color = sub_species)) + geom_point() +
  labs(
    title = "Two-Toed Sloth Species Length & Weight Distribuition" ,
    subtitle = "Comparing Hoffman vs. Linnaeus" , 
    x = "Total Length (cm)" ,
    y = "Weight (kg)") +
    scale_x_discrete(labels = c( "Hoffman's Two-Toed Sloth",
                                 "Linnaeus's Two-Toed Sloth") +
    scale_fill_manual(labels = c("Hoffman's Two-Toed Sloth",
                                 "Linnaeus's Two-Toed Sloth"),
                                 values = c("orchid4", "palevioletred"))
    
   
  

 
  #make scatter plot for three-toed species length and weight
  graph_3b <- data_3t %>% 
  ggplot(aes(x = total_length_cm,
             y = weight_kg,
             fill = sub_species)) + 
             geom_point(color = "black", pch = 21, size = 2, alpha = .5) +
             scale_y_continuous(breaks = seq(from = 0, to = 9, by = .5)) +
  labs(
    title = "Three-Toed Sloth Species Length & Weight Distribuition" ,
    subtitle = "Comparison of Three-Toed Sloth Species" , 
    x = "Total Length (cm)" ,
    y = "Weight (kg)") +
    scale_x_discrete(labels = c("Brown-Throated Sloth", "Maned Three-Toed Sloth",
                                 "Pale-Throated Sloth", "Pygmy Three-Toed Sloth" )) +
    scale_fill_manual(labels = c("Brown-Throated Sloth", "Maned Three-Toed Sloth",
                                 "Pale-Throated Sloth", "Pygmy Three-Toed Sloth"),
                                 values = c("dodgerblue3","lightskyblue1",
                                 "royalblue4", "cyan3"))
  
