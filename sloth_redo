# R project - Sloth Species and Conservation Stauts Analysis 
# Group: Antonella Mastropierro, Allison Sermarini, Giulia Lucaccioni

# Here are the following objectives for the project:
# What is the number of sloth species that are in each conservation status
# Which subspecies are most endangered
# What is the average claw size for each main species and which of the two main species have the longer claws on average
# What is the relationship between the subspecies and weight/size distribuition for for each of the two main species

# Install packages
install.packages("tidyverse")
install.packages("GGally")

# Load packages
library(tidyverse)
library(GGally)

# Create a data directory that can be reproducible
sloth_data <- read_csv("data/sloth_data.csv")

# View the characteristic of the dataset such as variable types
glimpse(sloth_data)

# View the number of columns in the dataset
ncol(sloth_data)

# View the number of rows in the dataset
nrow(sloth_data)

# Another way to summarize the dataset
str(sloth_data)

# Show the table version of the data set
tibble(sloth_data)

# The index column is not needed. Remove the index column
# and assign a new name to the new data set
sloth_data <- sloth_data[-1]

# Confirm that the Index column has been removed
glimpse(sloth_data)

# Rename some of the variables
sloth_data <- rename(sloth_data, "endangered_status" = "endangered",
              "main_species" = "specie", "sub_species" = "sub_specie")

# Let's confirm the changes
glimpse(sloth_data)

# We want to organize the rows by endangerment status from least concerning to critically endangered
# First, we need to create a shortcut for the order that we will input
endangerment_levels <- c("least_concern", "vulnerable", "critically_endangered")

# Now that the shortcut is created, we can reorder the data set by endangerment status
sloth_data <- sloth_data %>%
  mutate(endangered_status = factor(endangered_status, levels = endangerment_levels)) %>%
  arrange(endangered_status)

# Let's confirm the changes
glimpse(sloth_data)

# Sort columns by qualitative first and then quantitative second
sloth_data <- sloth_data[, c(4, 5, 2, 3, 7, 1, 6)]

# Let's confirm the changes
glimpse(sloth_data)

# Check for missing values
is.na(sloth_data)

# We can double-check for missing values
which(is.na(sloth_data))

# No missing values were found

# Check for duplicates
duplicated(sloth_data)

# We can double-check for duplicates
which(duplicated(sloth_data))

# No duplicates were found

# Now that all modifications are complete, we want to rename the modified data set to differentiate from the original
dat <- sloth_data

#Now that modified data set is renamed, let's check its characteristics to confirm
glimpse(dat)

# View the number of columns in the data set
ncol(dat)

# View the number of rows in the data set
nrow(dat)

# Another way to summarize the data set
str(dat)

# Show the table version of the data set
tibble(dat)

# We want to check the absolute frequency of the observations in the endangered_status column
table(dat$endangered_status)

# Stacked bar chart analyzing the conservation status of sloth subspecies
# Changing titles, colors, and labels for the bar chart 
ggplot(dat, aes(fill = sub_species, x = endangered_status)) + 
  geom_bar(sub_species = 'stack') +
  labs(
    title = "Endangered Status of Sloth Sub-Species" ,
    subtitle = "Number of Observations per Conservation Status" , 
    x = "Endangered Status" ,
    y = "Number of Observations",
    fill = "Subspecies") +
  scale_x_discrete(labels = c("Critically Endangered", "Least Concern", "Vulnerable")) +
  scale_fill_manual(labels = c("Brown-Throated Sloth", "Hoffman's Two-Toed Sloth",
                               "Linnaeus's Two-Toed Sloth", "Maned Three-Toed Sloth",
                               "Pale-Throated Sloth", "Pygmy Three-Toed Sloth"),
                    values = c("dodgerblue3", "tomato1", "gold2",
                                            "orchid4", "seagreen3","hotpink1"))
                                            
# Save the graph
ggsave("Endangered_Status_Bar_Chart.png", width = 10, height = 10)

# Close the graph
dev.off()


# Box plot graph comparing the claw length between the two-toed sloth and the three-toed sloth.
# Changing titles, colors, and labels for the box plot 
dat %>% 
  ggplot() +
  geom_boxplot(aes(x = main_species,
                   y = claw_length_cm,
                   fill = main_species)) +
  labs(
    title = "Claw Length Comparison of Main Species" ,
    subtitle = "Two-Toed Sloth vs. Three-Toed Sloth" , 
    x = "Main Species" ,
    y = "Claw Length (cm)",
    fill = "Main Species") +
  scale_x_discrete(labels = c("Three-Toed Sloth", "Two-Toed Sloth")) +
  scale_fill_manual(labels = c("Three-Toed Sloth", "Two-Toed Sloth"),
                    values = c("dodgerblue3", "brown2"))

# Save the graph
ggsave("Claw_Length_Boxplot.png", width = 10, height = 10)

# Close the graph
dev.off()

# To get a summary of the central tendencies for each main species and their claw lengths
summary(data_2t$claw_length_cm)
summary(data_3t$claw_length_cm)

# Add an additional column to the dataset by combining the size and tail length columns
total_length_cm <- dat$size_cm + dat$tail_length_cm

# Confirm the sum of the two variables
total_length_cm

# Add the new column to the dataset
dat <- cbind(dat, total_length_cm)

# Check for new column in the dataset
glimpse(dat)

# To filter out the data set for only the two-toed sloth species
data_2t <- dat %>%
  filter(main_species == "two_toed")

# Check the new dataframe to confirm
glimpse(data_2t)

# To filter out the dataset for only three-toed sloth species
data_3t <- dat %>%
  filter(main_species == "three_toed")

# Check the new dataframe to confirm
glimpse(data_3t)

# Scatter plot for two-toed species comparing length and weight
# Changing titles, colors, and labels for the scatter plot
data_2t %>% 
  ggplot(aes(x = total_length_cm,
             y = weight_kg,
             fill = sub_species)) + 
  geom_point(color = "black", pch = 21, size = 2, alpha = .5) +
  labs(
    title = "Two-Toed Sloth Species Length & Weight Distribution" ,
    subtitle = "Comparing Hoffman vs. Linnaeus" , 
    x = "Total Length (cm)" ,
    y = "Weight (kg)",
    fill = "Subspecies") +
  scale_fill_manual(labels = c("Hoffman's Two-Toed Sloth",
                               "Linnaeus's Two-Toed Sloth"), 
                    values = c("tomato1", "gold2"))

# Save the graph
ggsave("Two_Toed_Sloth_Species_LW.png", width = 15, height = 7)

# Close the graph
dev.off()

# Scatter plot for three-toed species length and weight
# Changing titles, colors, and labels for the scatter plot
data_3t %>% 
  ggplot(aes(x = total_length_cm,
             y = weight_kg,
             fill = sub_species)) + 
  geom_point(color = "black", pch = 21, size = 2, alpha = .5) +
  scale_y_continuous(breaks = seq(from = 0, to = 9, by = .5)) +
  labs(
    title = "Three-Toed Sloth Species Length & Weight Distribution" ,
    subtitle = "Comparison of Three-Toed Sloth Species" , 
    x = "Total Length (cm)" ,
    y = "Weight (kg)",
    fill = "Subspecies") +
  scale_fill_manual(labels = c("Brown-Throated Sloth", "Maned Three-Toed Sloth",
                               "Pale-Throated Sloth", "Pygmy Three-Toed Sloth"),
                    values = c("dodgerblue3", "orchid4", "seagreen3", "hotpink1"))

# Save the graph
ggsave("Three_Toed_Sloth_Species_LW.png", width = 15, height = 7)

# Close the graph
dev.off()

