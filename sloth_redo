# R project - Sloth Species and Conservation Stauts Analysis 
# Group: Antonella Mastropierro, Allison Sermarini, Giulia Lucaccioni

# Here are the following objectives for the project:
# What is the number of sloth species that are in each conservation status
# Which subspecies are most endangered
# What is the average claw size for each main species and which of the two main species have the longer claws on average
# What is the relationship between the subspecies and weight/size distribuition for for each of the two main species

# Install packages
install.packages("tidyverse")
install.packages("GGally")

# Load packages
library(tidyverse)
library(GGally)

# Create a data directory that can be reproducible
dat <- read_csv("data/sloth_data.csv")

# View the characteristic of the dataset such as variable types
glimpse(dat)

# View the number of columns in the dataset
ncol(dat)

# View the number of rows in the dataset
nrow(dat)

# Another way to summarize the dataset
str(dat)

# Show the table version of the data set
tibble(dat)

# The index column is not needed. Remove the index column
# and assign a new name to the new data set
dat <- select(data, -X)

# Confirm that the Index column has been removed
glimpse(dat)

# Rename some of the variables
dat <- rename(sloth_data, "endangered_status" = "endangered",
                     "main_species" = "specie", "sub_species" = "sub_specie")

# Cross-check
glimpse(dat)

# Organize rows by endangerement, from least to most concerning
endangerment_levels <- c("least_concern", "vulnerable", "critically_endangered")
dat<- dat %>%
  mutate(endangerment_status = factor(endangerment_status, levels = endangerment_levels)) %>%
  arrange(endangerment_status)

# Sort columns by qualitative first and then quantitative second
dat <- dat[, c(4, 5, 2, 3, 7, 1, 6)]
glimpse(dat)

# Check for missing values
is.na(dat)

# Double-check
which(is.na(dat))

# Check for duplicates
duplicated(dat)
which(duplicated(dat))

# We want to check the absolute frequency of the observations in the endangered_status column
table(dat$endangered_status)

# Stacked bar chart analyzing the conservation status of sloth subspecies
# Changing titles, colors, and labels for the bar chart 
graph_1 <- ggplot(dat, aes(fill = sub_species, x = endangered_status)) + 
  geom_bar(sub_species = 'stack') +
  labs(
    title = "Endangered Status of Sloth Sub-Species" ,
    subtitle = "Number of Observations per Conservation Status" , 
    x = "Endangered Status" ,
    y = "Number of Observations",
    fill = "Subspecies") +
  scale_x_discrete(labels = c("Critically Endangered", "Least Concern", "Vulnerable")) +
  scale_fill_manual(labels = c("Brown-Throated Sloth", "Hoffman's Two-Toed Sloth",
                               "Linnaeus's Two-Toed Sloth", "Maned Three-Toed Sloth",
                               "Pale-Throated Sloth", "Pygmy Three-Toed Sloth"),
                               values = c("dodgerblue3", "tomato1", "gold2",
                                            "orchid4", "seagreen3","hotpink1"))
                                            


# Box plot graph comparing the claw length between the two-toed sloth and the three-toed sloth.
# Changing titles, colors, and labels for the box plot 
graph_2 <- dat %>% 
  ggplot() +
  geom_boxplot(aes(x = main_species,
                   y = claw_length_cm,
                   fill = main_species)) +
     labs(
    title = "Claw Length Comparison of Main Species" ,
    subtitle = "Two-Toed Sloth vs. Three-Toed Sloth" , 
    x = "Main Species" ,
    y = "Claw Length (cm)",
    fill = "Main Species") +
  scale_x_discrete(labels = c("Three-Toed Sloth", "Two-Toed Sloth")) +
  scale_fill_manual(labels = c("Three-Toed Sloth", "Two-Toed Sloth"),
                    values = c("dodgerblue3", "brown2"))
                   
# To filter out the dataset for only the two-toed sloth species
data_2t <- dat %>%
  filter(main_species == "two_toed")

# Check the new dataframe to confirm
glimpse(data_2t)

# To filter out the dataset for only three-toed sloth species
data_3t <- dat %>%
  filter(main_species == "three_toed")

# Check the new dataframe to confirm
glimpse(data_3t)

# To get a summary of the central tendencies for each main species and their claw lengths
summary(data_2t$claw_length_cm)
summary(data_3t$claw_length_cm)

                  
# Add an additional column to the dataset by combining the size and tail length columns
total_length_cm <- dat$size_cm + dat$tail_length_cm

# Check new data set data
total_length_cm

# Add the new column to the dataset
dat <- cbind(dat, total_length_cm)

# Check for new column in the dataset
glimpse(dat)

# Scatter plot for two-toed species comparing length and weight
# Changing titles, colors, and labels for the scatter plot
graph_3a <- data_2t %>% 
  ggplot(aes(x = total_length_cm,
             y = weight_kg,
             fill = sub_species)) + 
  geom_point(color = "black", pch = 21, size = 2, alpha = .5) +
  labs(
    title = "Two-Toed Sloth Species Length & Weight Distribution" ,
    subtitle = "Comparing Hoffman vs. Linnaeus" , 
    x = "Total Length (cm)" ,
    y = "Weight (kg)",
    fill = "Subspecies") +
  scale_fill_manual(labels = c("Hoffman's Two-Toed Sloth",
                               "Linnaeus's Two-Toed Sloth"), 
                    values = c("tomato1", "gold2"))
                   
 # Scatter plot for three-toed species length and weight
 # Changing titles, colors, and labels for the scatter plot
  graph_3b <- data_3t %>% 
  ggplot(aes(x = total_length_cm,
             y = weight_kg,
             fill = sub_species)) + 
  geom_point(color = "black", pch = 21, size = 2, alpha = .5) +
  scale_y_continuous(breaks = seq(from = 0, to = 9, by = .5)) +
  labs(
    title = "Three-Toed Sloth Species Length & Weight Distribution" ,
    subtitle = "Comparison of Three-Toed Sloth Species" , 
    x = "Total Length (cm)" ,
    y = "Weight (kg)",
    fill = "Subspecies") +
  scale_fill_manual(labels = c("Brown-Throated Sloth", "Maned Three-Toed Sloth",
                               "Pale-Throated Sloth", "Pygmy Three-Toed Sloth"),
                    values = c("dodgerblue3", "orchid4", "seagreen3", "hotpink1"))
    
